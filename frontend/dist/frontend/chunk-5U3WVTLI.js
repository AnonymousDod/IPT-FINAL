import{a as E}from"./chunk-HNSN67LX.js";import{b as C}from"./chunk-5RCUSW7M.js";import{b as re}from"./chunk-7FSPOTPR.js";import{A as n,B as b,Ba as te,Ca as ie,E as V,F as p,Fa as ne,G as f,H as q,Ha as L,Ia as O,K as o,Ka as R,L as y,M as S,N as z,Q as U,R as W,T as B,V as H,X as G,Y as T,Z as w,_ as Y,aa as J,ca as K,k as g,ka as Q,ma as k,n as x,na as X,oa as Z,p as I,pa as A,q as M,qa as ee,r as _,s as v,u as l,ua as D,v as h,va as N,wa as F,x as u,y as s,z as t}from"./chunk-AFLXQZBF.js";import"./chunk-2XJVAMHT.js";var ce=function(i,c){return{"badge-active":i,"badge-inactive":c}};function ue(i,c){if(i&1){let e=V();t(0,"tr")(1,"td"),o(2),n(),t(3,"td"),o(4),n(),t(5,"td"),o(6),n(),t(7,"td"),o(8),n(),t(9,"td"),o(10),B(11,"date"),n(),t(12,"td")(13,"span",9),o(14),n()(),t(15,"td",10)(16,"button",11),p("click",function(){let m=_(e).$implicit,d=f();return v(d.viewRequests(m.id))}),o(17,"Requests"),n(),t(18,"button",11),p("click",function(){let m=_(e).$implicit,d=f();return v(d.viewWorkflows(m.id))}),o(19,"Workflows"),n(),t(20,"button",12),p("click",function(){let m=_(e).$implicit,d=f();return v(d.openTransferModal(m))}),o(21,"Transfer"),n(),t(22,"a",13),o(23,"Edit"),n(),t(24,"button",14),p("click",function(){let m=_(e).$implicit,d=f();return v(d.deleteEmployee(m.id))}),o(25,"Delete"),n()()()}if(i&2){let e=c.$implicit;l(2),y(e.employeeId),l(2),y(e.user==null?null:e.user.email),l(2),y(e.position),l(2),y(e.Department==null?null:e.Department.name),l(2),y(H(11,8,e.hireDate,"M/d/yyyy")),l(3),s("ngClass",W(11,ce,e.status==="Active",e.status!=="Active")),l(1),S(" ",e.status," "),l(8),q("routerLink","edit/",e.id,"")}}function fe(i,c){i&1&&b(0,"span",17)}function ge(i,c){i&1&&(t(0,"span"),o(1,"No employees found"),n())}function he(i,c){if(i&1&&(t(0,"tr")(1,"td",15),u(2,fe,1,0,"span",16),u(3,ge,2,0,"span",6),n()()),i&2){let e=f();l(2),s("ngIf",e.loading),l(1),s("ngIf",!e.loading)}}function ye(i,c){if(i&1&&(t(0,"option",34),o(1),n()),i&2){let e=c.$implicit;s("ngValue",e.id),l(1),y(e.name)}}function _e(i,c){i&1&&b(0,"span",35)}var ve=function(i){return{display:i,background:"rgba(0,0,0,0.4)"}};function be(i,c){if(i&1){let e=V();t(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"h5",22),o(5),n(),t(6,"button",23),p("click",function(){_(e);let r=f();return v(r.closeTransferModal())}),n()(),t(7,"div",24)(8,"div",25)(9,"label",26),o(10,"Department"),n(),t(11,"select",27),p("ngModelChange",function(r){_(e);let m=f();return v(m.selectedDepartmentId=r)}),t(12,"option",28),o(13,"-- Select Department --"),n(),u(14,ye,2,2,"option",29),n()()(),t(15,"div",30)(16,"button",31),p("click",function(){_(e);let r=f();return v(r.confirmTransfer())}),u(17,_e,1,0,"span",32),o(18," Transfer "),n(),t(19,"button",33),p("click",function(){_(e);let r=f();return v(r.closeTransferModal())}),o(20,"Cancel"),n()()()()()}if(i&2){let e=f();s("ngStyle",U(7,ve,e.showTransferModal?"block":"none")),l(5),S("Transfer Employee: ",e.selectedEmployee==null?null:e.selectedEmployee.employeeId,""),l(6),s("ngModel",e.selectedDepartmentId),l(3),s("ngForOf",e.departments),l(2),s("disabled",e.loading),l(1),s("ngIf",e.loading),l(2),s("disabled",e.loading)}}var ae=(()=>{class i{constructor(e,a,r){this.employeeService=e,this.alertService=a,this.router=r,this.employees=[],this.departments=[],this.loading=!1,this.showTransferModal=!1,this.selectedEmployee=null,this.selectedDepartmentId=null}ngOnInit(){this.loadEmployees(),this.loadDepartments()}loadEmployees(){this.loading=!0,this.employeeService.getAll().pipe(g()).subscribe({next:e=>{this.employees=e,this.loading=!1},error:e=>{this.alertService.error(e),this.loading=!1}})}loadDepartments(){this.employeeService.getDepartments().pipe(g()).subscribe(e=>{this.departments=e})}deleteEmployee(e){let a=this.employees.find(r=>r.id===e);confirm(`Are you sure you want to delete employee ${a.employeeId}?`)&&(this.loading=!0,this.employeeService.delete(e).pipe(g()).subscribe({next:()=>{this.alertService.success("Employee deleted successfully"),this.loadEmployees()},error:r=>{this.alertService.error(r),this.loading=!1}}))}viewRequests(e){this.router.navigate(["/requests"],{queryParams:{employeeId:e}})}viewWorkflows(e){this.router.navigate(["/workflows"],{queryParams:{employeeId:e}})}openTransferModal(e){this.selectedEmployee=e,this.selectedDepartmentId=e.departmentId,this.showTransferModal=!0}closeTransferModal(){this.showTransferModal=!1,this.selectedEmployee=null}confirmTransfer(){if(!this.selectedEmployee||!this.selectedDepartmentId){this.alertService.error("Please select a department");return}this.loading=!0,this.employeeService.transfer(this.selectedEmployee.id,this.selectedDepartmentId).pipe(g()).subscribe({next:()=>{this.alertService.success("Employee transferred successfully"),this.loadEmployees(),this.closeTransferModal()},error:e=>{this.alertService.error(e),this.loading=!1}})}static{this.\u0275fac=function(a){return new(a||i)(h(E),h(C),h(L))}}static{this.\u0275cmp=I({type:i,selectors:[["ng-component"]],decls:28,vars:3,consts:[[1,"card",2,"margin-top","20px"],[1,"card-header",2,"font-size","1.5rem","font-weight","bold"],[1,"card-body"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],[4,"ngIf"],["routerLink","add",1,"btn","btn-primary","float-end",2,"font-size","1.1rem","padding","10px 30px"],["class","modal","tabindex","-1",3,"ngStyle",4,"ngIf"],[1,"badge-custom",3,"ngClass"],[2,"white-space","nowrap"],[1,"btn","btn-sm","btn-info","me-1",2,"background","#00bcd4","border","none",3,"click"],[1,"btn","btn-sm","btn-warning","me-1",2,"color","#222","font-weight","500",3,"click"],[1,"btn","btn-sm","btn-primary",3,"routerLink"],[1,"btn","btn-sm","btn-danger","ms-1",3,"click"],["colspan","7",1,"text-center"],["class","spinner-border spinner-border-lg align-center",4,"ngIf"],[1,"spinner-border","spinner-border-lg","align-center"],["tabindex","-1",1,"modal",3,"ngStyle"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],[1,"form-label"],[1,"form-select",3,"ngModel","ngModelChange"],["value",""],[3,"ngValue",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-warning",2,"color","#222","font-weight","500",3,"disabled","click"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],[3,"ngValue"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(a,r){a&1&&(t(0,"div",0)(1,"div",1),o(2,"EMPLOYEES"),n(),t(3,"div",2)(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th"),o(9,"Employee ID"),n(),t(10,"th"),o(11,"Account"),n(),t(12,"th"),o(13,"Position"),n(),t(14,"th"),o(15,"Department"),n(),t(16,"th"),o(17,"Hire Date"),n(),t(18,"th"),o(19,"Status"),n(),t(20,"th"),o(21,"Actions"),n()()(),t(22,"tbody"),u(23,ue,26,14,"tr",5),u(24,he,4,2,"tr",6),n()()(),t(25,"button",7),o(26,"Add Employee"),n()()(),u(27,be,21,9,"div",8)),a&2&&(l(23),s("ngForOf",r.employees),l(1),s("ngIf",!(r.employees!=null&&r.employees.length)),l(3),s("ngIf",r.showTransferModal))},dependencies:[G,T,w,Y,N,F,D,k,A,O,J],styles:[`.badge-custom[_ngcontent-%COMP%] {
  display: inline-block;
  padding: 0.35em 0.8em;
  font-size: 1em;
  font-weight: 600;
  border-radius: 8px;
  color: #fff;
}
.badge-active[_ngcontent-%COMP%] {
  background: #388e6c;
}
.badge-inactive[_ngcontent-%COMP%] {
  background: #bdbdbd;
}`]})}}return i})();function Se(i,c){if(i&1&&(t(0,"div",25),o(1),n()),i&2){let e=f();l(1),y(e.errorMessage)}}function Ce(i,c){if(i&1&&(t(0,"option",26),o(1),n()),i&2){let e=c.$implicit;s("value",e.id),l(1),z(" ",e.email," (",e.role==="Admin"?"Admin User":"Normal User",") ")}}function Ee(i,c){if(i&1&&(t(0,"option",26),o(1),n()),i&2){let e=c.$implicit;s("value",e.id),l(1),y(e.name)}}function xe(i,c){i&1&&b(0,"span",27)}var P=(()=>{class i{constructor(e,a,r,m,d){this.route=e,this.router=a,this.employeeService=r,this.alertService=m,this.accountService=d,this.employee={},this.accounts=[],this.departments=[],this.loading=!1,this.submitted=!1,this.errorMessage=""}ngOnInit(){this.id=this.route.snapshot.params.id,this.accountService.getAll().subscribe(e=>{this.accounts=e.filter(a=>a.status==="Active")}),this.employeeService.getDepartments().subscribe(e=>this.departments=e),this.id?this.employeeService.getById(this.id).pipe(g()).subscribe(e=>{this.employee=e,this.employee.accountId=e.user?.id,this.employee.departmentId=e.department?.id,e.hireDate&&(this.employee.hireDate=e.hireDate.split("T")[0])}):this.employeeService.getAll().pipe(g()).subscribe(e=>{let a=e.map(d=>d.employeeId).filter(d=>/^EMP\d+$/.test(d)),r=0;a.forEach(d=>{let $=parseInt(d.replace("EMP",""),10);$>r&&(r=$)});let m=(r+1).toString().padStart(3,"0");this.employee.employeeId=`EMP${m}`})}onSubmit(){this.submitted=!0,this.loading=!0,this.employee.accountId&&(this.employee.userId=this.employee.accountId),this.id?this.updateEmployee():this.createEmployee()}createEmployee(){this.employeeService.create(this.employee).pipe(g()).subscribe({next:()=>{this.alertService.success("Employee created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:e=>{this.errorMessage=e.error?.message||"An error occurred while creating the employee",this.alertService.error(e),this.loading=!1}})}updateEmployee(){this.employeeService.update(this.id,this.employee).pipe(g()).subscribe({next:()=>{this.alertService.success("Update successful",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:e=>{this.errorMessage=e.error?.message||"An error occurred while updating the employee",this.alertService.error(e),this.loading=!1}})}static{this.\u0275fac=function(a){return new(a||i)(h(ne),h(L),h(E),h(C),h(re))}}static{this.\u0275cmp=I({type:i,selectors:[["ng-component"]],decls:43,vars:13,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],["class","alert alert-danger",4,"ngIf"],[3,"ngSubmit"],[1,"form-group","mb-3"],["for","employeeId"],["type","text","name","employeeId",1,"form-control",3,"ngModel","disabled","ngModelChange"],["for","accountId"],["name","accountId",1,"form-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","position"],["type","text","name","position",1,"form-control",3,"ngModel","ngModelChange"],["for","departmentId"],["name","departmentId",1,"form-select",3,"ngModel","ngModelChange"],["for","hireDate"],["type","date","name","hireDate",1,"form-control",3,"ngModel","ngModelChange"],["for","status"],["name","status",1,"form-select",3,"ngModel","ngModelChange"],["value","Active"],["value","Inactive"],[1,"form-group"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["routerLink","../",1,"btn","btn-link"],[1,"alert","alert-danger"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(a,r){a&1&&(t(0,"div",0)(1,"div",1)(2,"h3"),o(3),n()(),t(4,"div",2),u(5,Se,2,1,"div",3),t(6,"form",4),p("ngSubmit",function(){return r.onSubmit()}),t(7,"div",5)(8,"label",6),o(9,"Employee ID"),n(),t(10,"input",7),p("ngModelChange",function(d){return r.employee.employeeId=d}),n()(),t(11,"div",5)(12,"label",8),o(13,"Account"),n(),t(14,"select",9),p("ngModelChange",function(d){return r.employee.accountId=d}),u(15,Ce,2,3,"option",10),n()(),t(16,"div",5)(17,"label",11),o(18,"Position"),n(),t(19,"input",12),p("ngModelChange",function(d){return r.employee.position=d}),n()(),t(20,"div",5)(21,"label",13),o(22,"Department"),n(),t(23,"select",14),p("ngModelChange",function(d){return r.employee.departmentId=d}),u(24,Ee,2,2,"option",10),n()(),t(25,"div",5)(26,"label",15),o(27,"Hire Date"),n(),t(28,"input",16),p("ngModelChange",function(d){return r.employee.hireDate=d}),n()(),t(29,"div",5)(30,"label",17),o(31,"Status"),n(),t(32,"select",18),p("ngModelChange",function(d){return r.employee.status=d}),t(33,"option",19),o(34,"Active"),n(),t(35,"option",20),o(36,"Inactive"),n()()(),t(37,"div",21)(38,"button",22),u(39,xe,1,0,"span",23),o(40," Save "),n(),t(41,"a",24),o(42,"Cancel"),n()()()()()),a&2&&(l(3),S("",r.id?"Edit":"Add"," Employee"),l(2),s("ngIf",r.errorMessage),l(5),s("ngModel",r.employee.employeeId)("disabled",r.id),l(4),s("ngModel",r.employee.accountId),l(1),s("ngForOf",r.accounts),l(4),s("ngModel",r.employee.position),l(4),s("ngModel",r.employee.departmentId),l(1),s("ngForOf",r.departments),l(4),s("ngModel",r.employee.hireDate),l(4),s("ngModel",r.employee.status),l(6),s("disabled",r.loading),l(1),s("ngIf",r.loading))},dependencies:[T,w,ee,N,F,Q,D,k,X,A,Z,O],encapsulation:2})}}return i})();var Ie=[{path:"",component:ae},{path:"add",component:P},{path:"edit/:id",component:P}],se=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=M({type:i})}static{this.\u0275inj=x({imports:[R.forChild(Ie),R]})}}return i})();var Be=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=M({type:i})}static{this.\u0275inj=x({imports:[K,ie,te,se]})}}return i})();export{Be as EmployeesModule};
