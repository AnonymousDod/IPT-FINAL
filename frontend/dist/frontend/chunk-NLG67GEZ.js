import{b as ie}from"./chunk-5RCUSW7M.js";import{a as W,b as te}from"./chunk-7FSPOTPR.js";import{A as n,B as V,Ba as X,Ca as Y,E as U,F as c,Fa as A,G as f,Ha as Z,Ia as ee,K as r,Ka as $,L as g,M as C,T as q,U as D,Y as k,Z as y,ba as B,ca as P,ea as G,k as w,ka as H,m as O,ma as E,n as v,na as J,o as R,oa as z,p as _,pa as M,q as S,qa as K,r as j,s as F,u as a,ua as I,v as m,va as x,wa as b,x as u,y as s,ya as Q,z as i}from"./chunk-AFLXQZBF.js";import"./chunk-2XJVAMHT.js";var T=(()=>{class t{constructor(e){this.http=e,this.apiUrl=`${W.apiUrl}/workflows`}getAll(){return this.http.get(this.apiUrl)}getById(e){return this.http.get(`${this.apiUrl}/${e}`)}create(e){return this.http.post(this.apiUrl,e)}update(e,l){return this.http.put(`${this.apiUrl}/${e}`,l)}delete(e){return this.http.delete(`${this.apiUrl}/${e}`)}getDepartments(){return this.http.get(`${W.apiUrl}/departments`)}getByEmployeeId(e){return this.http.get(`/workflows/employee/${e}`)}updateStatus(e,l){return this.http.put(`/workflows/${e}/status`,{status:l})}static{this.\u0275fac=function(l){return new(l||t)(R(G))}}static{this.\u0275prov=O({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function de(t,h){t&1&&(i(0,"th"),r(1,"Actions"),n())}function pe(t,h){if(t&1){let e=U();i(0,"td")(1,"select",7),c("ngModelChange",function(o){j(e);let d=f().$implicit;return F(d.status=o)})("change",function(){j(e);let o=f().$implicit,d=f();return F(d.updateStatus(o))}),i(2,"option"),r(3,"Pending"),n(),i(4,"option"),r(5,"Approved"),n(),i(6,"option"),r(7,"Rejected"),n()()()}if(t&2){let e=f().$implicit;a(1),s("ngModel",e.status)}}function me(t,h){if(t&1&&(i(0,"tr")(1,"td"),r(2),n(),i(3,"td"),r(4),q(5,"json"),n(),i(6,"td"),r(7),n(),u(8,pe,8,1,"td",5),n()),t&2){let e=h.$implicit,l=f(),o;a(2),g(e.type),a(2),g(D(5,4,e.details)),a(3),g(e.status),a(1),s("ngIf",((o=l.account())==null?null:o.role)==="Admin")}}var oe=(()=>{class t{constructor(e,l,o){this.workflowService=e,this.accountService=l,this.route=o,this.workflows=[]}ngOnInit(){this.employeeId||(this.employeeId=this.route.snapshot.queryParams.employeeId),this.employeeId&&this.workflowService.getByEmployeeId(this.employeeId).subscribe(e=>this.workflows=e)}account(){return this.accountService.accountValue}updateStatus(e){this.workflowService.updateStatus(e.id,e.status).subscribe()}static{this.\u0275fac=function(l){return new(l||t)(m(T),m(te),m(A))}}static{this.\u0275cmp=_({type:t,selectors:[["app-workflow-list"]],inputs:{employeeId:"employeeId"},decls:17,vars:3,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"form-select","d-inline-block","w-auto",3,"ngModel","ngModelChange","change"]],template:function(l,o){if(l&1&&(i(0,"div",0)(1,"div",1),r(2),n(),i(3,"div",2)(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th"),r(9,"Type"),n(),i(10,"th"),r(11,"Details"),n(),i(12,"th"),r(13,"Status"),n(),u(14,de,2,0,"th",5),n()(),i(15,"tbody"),u(16,me,9,6,"tr",6),n()()()()()),l&2){let d;a(2),C("Workflows for Employee (",o.employeeId,")"),a(12),s("ngIf",((d=o.account())==null?null:d.role)==="Admin"),a(2),s("ngForOf",o.workflows)}},dependencies:[k,y,x,b,I,E,M,B],encapsulation:2})}}return t})();function ce(t,h){if(t&1&&(i(0,"div",26),r(1),n()),t&2){let e=f();a(1),g(e.errorMessage)}}function ue(t,h){if(t&1&&(i(0,"option",27),r(1),n()),t&2){let e=h.$implicit;s("value",e.id),a(1),g(e.name)}}function fe(t,h){t&1&&V(0,"span",28)}var L=(()=>{class t{constructor(e,l,o,d){this.route=e,this.router=l,this.workflowService=o,this.alertService=d,this.workflow={},this.departments=[],this.loading=!1,this.submitted=!1,this.errorMessage=""}ngOnInit(){this.id=this.route.snapshot.params.id,this.workflowService.getDepartments().subscribe(e=>this.departments=e),this.id&&this.workflowService.getById(this.id).pipe(w()).subscribe(e=>this.workflow=e)}onSubmit(){this.submitted=!0,this.loading=!0,this.id?this.updateWorkflow():this.createWorkflow()}createWorkflow(){this.workflowService.create(this.workflow).pipe(w()).subscribe({next:()=>{this.alertService.success("Workflow created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:e=>{this.errorMessage=e.error?.message||"An error occurred while creating the workflow",this.alertService.error(e),this.loading=!1}})}updateWorkflow(){this.workflowService.update(this.id,this.workflow).pipe(w()).subscribe({next:()=>{this.alertService.success("Update successful",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:e=>{this.errorMessage=e.error?.message||"An error occurred while updating the workflow",this.alertService.error(e),this.loading=!1}})}static{this.\u0275fac=function(l){return new(l||t)(m(A),m(Z),m(T),m(ie))}}static{this.\u0275cmp=_({type:t,selectors:[["ng-component"]],decls:44,vars:10,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],["class","alert alert-danger",4,"ngIf"],[3,"ngSubmit"],[1,"form-group","mb-3"],["for","name"],["type","text","name","name","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","type"],["name","type","required","",1,"form-select",3,"ngModel","ngModelChange"],["value","leave"],["value","expense"],["value","transfer"],["for","departmentId"],["name","departmentId","required","",1,"form-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","description"],["name","description","rows","3",1,"form-control",3,"ngModel","ngModelChange"],["for","status"],["name","status","required","",1,"form-select",3,"ngModel","ngModelChange"],["value","active"],["value","inactive"],[1,"form-group"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1",4,"ngIf"],["routerLink","../",1,"btn","btn-link"],[1,"alert","alert-danger"],[3,"value"],[1,"spinner-border","spinner-border-sm","me-1"]],template:function(l,o){l&1&&(i(0,"div",0)(1,"div",1)(2,"h3"),r(3),n()(),i(4,"div",2),u(5,ce,2,1,"div",3),i(6,"form",4),c("ngSubmit",function(){return o.onSubmit()}),i(7,"div",5)(8,"label",6),r(9,"Workflow Name"),n(),i(10,"input",7),c("ngModelChange",function(p){return o.workflow.name=p}),n()(),i(11,"div",5)(12,"label",8),r(13,"Workflow Type"),n(),i(14,"select",9),c("ngModelChange",function(p){return o.workflow.type=p}),i(15,"option",10),r(16,"Leave Approval"),n(),i(17,"option",11),r(18,"Expense Approval"),n(),i(19,"option",12),r(20,"Transfer Approval"),n()()(),i(21,"div",5)(22,"label",13),r(23,"Department"),n(),i(24,"select",14),c("ngModelChange",function(p){return o.workflow.departmentId=p}),u(25,ue,2,2,"option",15),n()(),i(26,"div",5)(27,"label",16),r(28,"Description"),n(),i(29,"textarea",17),c("ngModelChange",function(p){return o.workflow.description=p}),n()(),i(30,"div",5)(31,"label",18),r(32,"Status"),n(),i(33,"select",19),c("ngModelChange",function(p){return o.workflow.status=p}),i(34,"option",20),r(35,"Active"),n(),i(36,"option",21),r(37,"Inactive"),n()()(),i(38,"div",22)(39,"button",23),u(40,fe,1,0,"span",24),r(41," Save "),n(),i(42,"a",25),r(43,"Cancel"),n()()()()()),l&2&&(a(3),C("",o.id?"Edit":"Add"," Workflow"),a(2),s("ngIf",o.errorMessage),a(5),s("ngModel",o.workflow.name),a(4),s("ngModel",o.workflow.type),a(10),s("ngModel",o.workflow.departmentId),a(1),s("ngForOf",o.departments),a(4),s("ngModel",o.workflow.description),a(4),s("ngModel",o.workflow.status),a(6),s("disabled",o.loading),a(1),s("ngIf",o.loading))},dependencies:[k,y,K,x,b,H,I,E,J,Q,M,z,ee],encapsulation:2})}}return t})();var he=[{path:"",component:oe},{path:"add",component:L},{path:"edit/:id",component:L}],re=(()=>{class t{static{this.\u0275fac=function(l){return new(l||t)}}static{this.\u0275mod=S({type:t})}static{this.\u0275inj=v({imports:[$.forChild(he),$]})}}return t})();var $e=(()=>{class t{static{this.\u0275fac=function(l){return new(l||t)}}static{this.\u0275mod=S({type:t})}static{this.\u0275inj=v({imports:[P,Y,X,re]})}}return t})();export{$e as WorkflowsModule};
